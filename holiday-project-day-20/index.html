<!DOCTYPE html>
<head prefix='og: http://ogp.me/ns#'>
  <meta charset='utf-8'>
  <meta content='IE=edge' http-equiv='X-UA-Compatible'>
  <meta content='width=device-width, initial-scale=1.0' name='viewport'>
  <meta content='프로젝트 20일: 회사의 합병 소식' property='og:title'>
  <meta content='website' property='og:type'>
  <meta content='http://hatemogi.com/holiday-project-day-20/' property='og:url'>
  <meta content='일하고 있는 회사가 합병하는 소식이 알려진 날. 그 느낌은 어떤가?' property='og:description'>
  <title>프로젝트 20일: 회사의 합병 소식</title>
  <link href='/css/application.css' rel='stylesheet' type='text/css'>
  <link href='/css/highlight/foundation.css' rel='stylesheet' type='text/css'>
  <link href='/img/favicon.png' rel='shortcut icon'>
</head>
<body>
  <div class='container'>
    <div class='header'>
      <ul class='nav nav-pills pull-right'>
        <li>
          <a href='/'>홈</a>
        </li>
        <li>
          <a href='/articles/'>글</a>
        </li>
        <li>
          <a href='/show-your-work/'>작업</a>
        </li>
        <li>
          <a href='/about/'>소개</a>
        </li>
      </ul>
      <h3 class='logo'>hatemogi</h3>
    </div>
  </div>
  <section id='main-content'>
    <div class='container'>
      <div class='page-header'>
        <h1>
          프로젝트 20일: 회사의 합병 소식
          <small>2014-05-26</small>
        </h1>
      </div>
      <p>개인 프로젝트 20일째, 오늘은 내가 근무하는 회사가 다른 회사와 합병한다고 공시가 났다.</p>
      
      <p>겉으로야 합병이지만, 사실상 내용을 열어보면 우리가 인수당하는 입장이고, 앞으로 어떻게 될지는 알 수 없다. 당장 직속상관이 바뀌어도 업무가 확 바뀌는 것이 당연한데, 심지어 최대 주주가 바뀌는 일이니, 변화가 없을 수야 없겠지. 10년간 우리 회사가 다른 회사를 인수하거나 분사하는 것을 지켜봐 왔지만, 피인수는 처음이다. 나름 다채로운 근로자 생활이 되려나 보다.</p>
      
      <p>회사 분위기도 살피고, 사장님 발표도 들으러 잠시 출근했다. 출근한 김에, 팀원들에게 <a href="/holiday-project-day-19/">어제 알아본 RequireJS</a>와, Async와 Promise에 대해서도 물어봤다. 팀원들도 다행히 아직은 큰 동요가 없다, 아직 뭐 실감 날 일은 없으니까. 나도 아직은 멍하니 잘 모르겠고 말이다.</p>
      
      <h2>AMD 잘 쓰고 있나?</h2>
      
      <p>합병 관련해서야 내가 할 수 있는 일은 따로 없을 테고, 개인 프로젝트 얘기로 돌아오자.  이미 Node.js로 사내 서비스를 개발하고 있는 팀원들에게 물어보니, 아직 RequireJS같은 AMD를 쓰고 있지는 않았고, Promise 역시 스펙 정도만 보고, 실제로 써보지는 않은 단계였다.</p>
      
      <blockquote><p>&ldquo;minify 해서 다 로드해놓으면 되죠. JS 파일 다 합쳐봐야 얼마나 되나요? 그걸 굳이 나눠서 로드할 필요 있나요?&rdquo;</p></blockquote>
      
      <p>맞는 말이다. 그래 봐야 텍스트 파일 아닌가? 신속한 네트워크 환경에서 텍스트 파일, 그것도 gzip으로 묶으면 이미지 파일 크기 정도인데, 그걸 어렵사리 lazy loading 하겠다고 노력하는 것도 지나친 수고일 수 있다.</p>
      
      <h2>Promise는?</h2>
      
      <p><a href="/holiday-project-day-10/">10일차에 알아본 Async.js로 콜백 중첩을 푸는 방법</a>에 대해서도 찜찜한 구석이 있어서, 다른 대안인 Promise에 대해서도 물어봤다. 한 명은 Promise는 오버엔지니어링인 것 같고, Async.js를 만족스럽게 쓰고 있다 했고, 한 명은, Promise를 써보지는 않고 스펙만 보았으나, 괜찮아 보인다고 했다.</p>
      
      <p>아직 모르는 입장에서는 남의 의견이 궁금하고, 또 중요하지만, 스스로 느끼기에도 async.waterfall도 아직 콜백 지옥을 완전히 해결해주지 못하는 것 같아서, Promise 관련해서도 조금 더 봤다. 스펙이 정리되고 있는 단계인데, 아직 지원하지 않는 JS엔진들이 더러 있어서, 그걸 메꿔주는 모듈들이 있었다.</p>
      
      <blockquote><p><a href="http://promisejs.org/">http://promisejs.org/</a></p></blockquote>
      
      <pre><code class="coffee">nodegit = require("nodegit")&#x000A;Promise = require("promise")&#x000A;&#x000A;nodegitPath = ".git/modules/git/nodegit/"&#x000A;&#x000A;openRepo = Promise.denodeify(nodegit.Repo.open)&#x000A;&#x000A;describe '[CoffeeScript w/promise.js] nodegit 저장소', () -&gt;&#x000A;  it '열어서 커밋 찾아보기', (done) -&gt;&#x000A;    sha = "e9ec116a8fb2ea051a4c2d46cba637b3fba30575"&#x000A;    openRepo(nodegitPath).then((repo) -&gt;&#x000A;      expect(repo.path()).toMatch /\/git\/nodegit\/$/&#x000A;</code></pre>
      
      <p><code>nodegit.Repo</code>의 <code>open</code>이  일반 콜백 방식의 함수이고, 이걸 <code>Promise</code> 식으로 바꿔서 호출하면, <code>then()</code>에서 성공했을 경우의 결과 값으로 그다음 진행을 할 수 있다.</p>
      
      <p>이렇게 한 단계의 콜백은 쉽게 <code>Promise.then()</code> 으로 풀어쓰는 걸 알겠는데, waterfall을 해결하는 방법은 아직 와 닿지 않는다.</p>
      
      <blockquote><p><a href="http://trevorburnham.com/presentations/flow-control-with-promises/">http://trevorburnham.com/presentations/flow-control-with-promises/</a></p></blockquote>
      
      <p>여기에 괜찮은 슬라이드 자료를 찾았다. 틈날 때 다시 공을 들여 읽어봐야겠다.</p>
      
      <h2><a href="http://coffeescript.org/">CoffeeScript</a></h2>
      
      <p>또 한가지, 물어봤다. 커피스크립트는 어떻게 쓰고 있는지. 클라이언트 측 JS를 위해서야 컴파일도 미리 해놓고 최소화하는 것도 중요할 테니 미리미리 컴파일한다고 하더라도, 서버 측에서까지 매번 미리 컴파일하며, 각 커피 소스마다 JS파일 따로 만들어 놓는 게 여간 번거롭지 않았다. Ruby로 개발할 때야 신경 쓰지 않았다, 클라이언트 측 커피 코드만 컴파일했었으니까.</p>
      
      <p>어쨌건, 커피를 즐겨 쓰는 팀원 분의 의견은, 그냥 서버 실행을 <code>node</code>가 아닌 <code>coffee</code>로 한다는 것. 노드로 했을 경우에도, 한 줄의 설정으로 그다음 <code>require</code>부터는 커피스크립트 소스를 그대로 읽을 수 있으니, 최초 진입 소스만 JS로 해도 되고, 아니면 최초 실행부터 아예 <code>coffee</code>로 하면 최초 진입 소스와 그 후 require 모두 커피스크립트를 그대로 활용할 수 있다. 그래 그게 낫겠다. 서버 측이야, 떠 있는 애플리케이션이 계속 재활용되니까, 클라이언트 측처럼 매 클라이언트가 매번 컴파일 해야하는 것도 아니고 큰 부담 없겠다.</p>
      
      <p>지금까지 프로젝트 소스에는 커피스크립트와 JS를 혼용했는데, 오늘부로, 서버 측 코드는 커피스크립트로 통일했다. <a href="http://js2coffee.org/">js2coffee</a>로 변환하고, 눈으로 직접보고 아주 약간씩만 손봤다.</p>
      
      <p>클라이언트 측 소스는 원래 하던 대로 커피스크립트 파일을 <code>asset</code> 디렉터리에 두고, 그때그때 JS 파일로 변환하는 방식을 유지하기로 한다.</p>
      
      <h2>프로젝트는 지지부진</h2>
      
      <p>오늘의 성과는, 커피스크립트로 통일 전환한 것이 전부다. Promise라도 조금 더 이해할 수 있었으면 정리할 내용이 있었을 것 같은데 아쉽다. 합병 소식에 어수선했다고 얘기하면 핑계겠지.</p>
      
      <p>아! 그래서 결국 AMD를 쓰는 것에 대한 오늘의 방안은, D3.js를 비롯한 대부분은 AMD 방식으로 로딩하고, AngularJS만 일반 동기식으로 로딩하자는 것이다. AngularJS도 익숙하지 않고, AMD방식의 RequireJS도 익숙치 않아서, 어딘가 문제가 발생하면, 두 부분 중 어디서 잘못했는지 파악하기가 어렵다. 따라서 Angular만이라도 일반적(!)으로 로딩해서, 우선 문제 범위를 줄여놓고 진행하다가, 익숙해지면, 다시 비동기 로딩으로 전환하는 방법을 택하겠다.</p>
      
      <p>어떤 개발이든 마찬가지다. 무언가를 변경하거나 새로 할 때는, 불투명한 범위를 최소화해놓고, 부분과 단계별로 <a href="https://en.wikipedia.org/wiki/Divide_and_conquer_algorithms">Divide &amp; Conquer</a>하는 것이 기본이다.</p>
      
      <p>다행히, 오늘 작업 중에야 RequireJS가 조금 파악이 되어, 조만간 AnguarJS도 비동기 로딩할 수 있을 것 같은 기대가 든다.</p>
      
      <p>오늘은 여기까지.</p>
      <div class='page-header'>
        <h4>
          30일 프로젝트 글 목록
        </h4>
      </div>
      <blockquote>
        <ul>
        <li><a href="/holiday-project-day-01/">(05/07) 프로젝트 1일: 웹 브라우저 JS 테스트 환경 - karma &amp; jasmine</a></li>
        <li><a href="/holiday-project-day-02/">(05/08) 프로젝트 2일: 서버 측 JS 테스트 환경 - jasmine-node</a></li>
        <li><a href="/holiday-project-day-03/">(05/09) 프로젝트 3일: express 테스트 환경 - supertest</a></li>
        <li><a href="/holiday-project-day-04/">(05/10) 프로젝트 4일: 웹 환경 패키지 매니저 - bower</a></li>
        <li><a href="/holiday-project-day-05/">(05/11) 프로젝트 5일: 문법 하이라이팅 - highlight.js</a></li>
        <li><a href="/holiday-project-day-06/">(05/12) 프로젝트 6일: 그래프 그리기 - graphviz &amp; D3.js</a></li>
        <li><a href="/holiday-project-day-07/">(05/13) 프로젝트 7일: graphviz 노드에 웹 링크 걸기</a></li>
        <li><a href="/holiday-project-day-08/">(05/14) 프로젝트 8일: D3.js 트랜지션(Transitions)</a></li>
        <li><a href="/holiday-project-day-09/">(05/15) 프로젝트 9일: Node.js로 Git저장소 다루기</a></li>
        <li><a href="/holiday-project-day-10/">(05/16) 프로젝트 10일: Async.js로 콜백 중첩을 풀기</a></li>
        <li><a href="/holiday-project-day-11/">(05/17) 프로젝트 11일: Git 커밋 그래프 그리기 도전</a></li>
        <li><a href="/holiday-project-day-12/">(05/18) 프로젝트 12일: 그래프 그리기 도전 #2</a></li>
        <li><a href="/holiday-project-day-13/">(05/19) 프로젝트 13일: 컨테이너 기반 가상화 프레임워크 - Docker</a></li>
        <li><a href="/holiday-project-day-14/">(05/20) 프로젝트 14일: Heroku에 Node.js 애플리케이션 배포</a></li>
        <li><a href="/holiday-project-day-15/">(05/21) 프로젝트 15일: AngularJS 코드스쿨 강좌 소개</a></li>
        <li><a href="/holiday-project-day-16/">(05/22) 프로젝트 16일: 중간 점검 - 왜 이 프로젝트를 하나?</a></li>
        <li><a href="/holiday-project-day-17/">(05/23) 프로젝트 17일: Travis CI - 지속적 통합 서비스</a></li>
        <li><a href="/holiday-project-day-18/">(05/24) 프로젝트 18일: Grunt - 자바스크립트 작업 실행기</a></li>
        <li><a href="/holiday-project-day-19/">(05/25) 프로젝트 19일: RequireJS - 비동기(async) JS 로더'</a></li>
        <li><a href="/holiday-project-day-20/">(05/26) 프로젝트 20일: 회사의 합병 소식</a></li>
        <li><a href="/holiday-project-day-21/">(05/29) 프로젝트 21일: AngularJS 컨트롤러 테스트 코드</a></li>
        </ul>
      </blockquote>
    </div>
  </section>
  <div class='container'>
    <footer>
      <div class='pull-right'>
        &copy; 2012-2014
        <a href='https://twitter.com/hatemogi'>@hatemogi</a>
      </div>
    </footer>
  </div>
  <script src='/js/application.js' type='text/javascript'></script>
</body>
